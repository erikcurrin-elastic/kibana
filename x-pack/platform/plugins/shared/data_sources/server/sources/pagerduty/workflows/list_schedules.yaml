version: '1'
name: sources.pagerduty.list_schedules
description: 'List schedules in PagerDuty. Supports pagination, filtering by query, and including related resources. Query format: free-text search string that searches across name and description fields (e.g., "primary" or "weekend").'
enabled: true
triggers:
  - type: manual
inputs:
  - name: limit
    type: number
    required: false
  - name: offset
    type: number
    required: false
  - name: query
    type: string
    required: false
    description: Free-text search string that searches across name and description fields (e.g., "primary" or "weekend")
  - name: include
    type: array
    required: false
    description: "Array of related resources to include, valid values are: (schedule_layers,overrides_subschedule,final_schedule)"
  - name: time_zone
    type: string
    required: false
    description: Time zone in which dates in the result will be rendered (IANA time zone database name)
steps:
  - name: list-schedules
    type: mcp.callTool
    connector-id: <%= stackConnectorId %>
    with:
      name: "list_schedules"
      parseResponse: true
      arguments:
        query_model:
          query: "${{inputs.query}}"
          limit: ${{inputs.limit}}
          offset: ${{inputs.offset}}
          include: ${{inputs.include}}
          time_zone: "${{inputs.time_zone}}"
  - name: get-schedules
    type: data.map
    items: "${{steps['list-schedules'].output.parsed.response}}"
    with:
      transform:
        pick:
        id:
        name:
        description:
        time_zone:
        schedule_layers:
          id:
          name:
          start:
          rotation_virtual_start:
          rotation_turn_length_seconds:
          users:
            user:
              id:
              summary:
        users:
          id:
          summary:
